---
output: github_document
---

<!--README.md is generated from README.Rmd. Please edit that file -->

 <!-- badges: start -->
  [![R-CMD-check](https://github.com/cfjdoedens/drawsneeded/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/cfjdoedens/drawsneeded/actions/workflows/R-CMD-check.yaml)
  <!-- badges: end -->

```{r init, message=TRUE, warning=TRUE, include=FALSE, paged.print=TRUE}
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
```

# drawsneeded

Supports monetary unit sampling.
In monetary unit sampling we have a file of monetary statements.
In general this concerns money that has been spent.
We want to estimate the percentage of money from the file that was wrongfully spent, the error rate.

This very tiny package has the function drawsneeded().
The function gives an estimate of the number of monetary unit
draws needed
to establish with some certainty that the error rate is below a certain threshold.

This is only a good estimation.
Due to randomness, the actual number of monetary unit draws needed
might be either to
low or to high.

The package also has the function drawsneeded_plot() which calls drawsneeded()
and shows the result in a plot.

## Installation
You can install the development version of drawsneeded from [GitHub](https://github.com/) with:
```{r install, message=TRUE, warning=TRUE, echo=TRUE}
if (file.exists("/home/crist-jan/R/x86_64-pc-linux-gnu-library/4.5/drawsneeded")) {
  # We are executing on the author machine, use the development version available there.
  library("drawsneeded")
  print("using files directly from author of package; not from github")
} else {
  # Use the github version.
  if (!requireNamespace("pak", quietly = TRUE)) {
    install.packages("pak")
  }
  pak::pak("cfjdoedens/drawsneeded")
  print("using files from github")
}
```

## Example: 0.1 percent error expected

Suppose you know from previous experience
that a small error rate might exist in the mass of monetary statements.
You estimate the error rate to be no more than 0.1 percent of the total
mass in money.
So you set expected_error_rate to 0.001.
You need a result with 95% certainty.
So you set certainty to 0.95, You decide that the maximum number of samples you are willing to
draw and check is 500.
So you set max_n to 500.

```{r example-tiny-percent-errors-expected}
drawsneeded(expected_error_rate = 0.001, allowed_error_rate = 0.01, cert = 0.95, max_n = 500)
```
The conclusion is that you will need at least 365 samples.

In a picture this looks like:
```{r plot-example-tiny-percent-errors-expected}
drawsneeded_plot(expected_error_rate = 0.001,  allowed_error_rate = 0.01, cert = 0.95, max_n = 500)
```

## Example: no error expected

However, you might expect to see no error at all. Then you could
calculate as follows:
```{r example-no-errors-expected}
drawsneeded(expected_error_rate = 0.0, allowed_error_rate = 0.01, cert = 0.95, max_n = 500)
```

So probably 298 samples is sufficient.

In a picture this looks like:
```{r plot-example-no-errors-expected}
drawsneeded_plot(expected_error_rate = 0.0, allowed_error_rate = 0.01, cert = 0.95, max_n = 500)
```

## Example: multiple  expected_error_rate s

Suppose we want to try several different expected error rates in one go:
```{r example-several-different-expected-error-rates}
drawsneeded(expected_error_rate = seq(from = 0.0, by = 0.001, to = 0.009), allowed_error_rate = 0.01, cert = 0.95, max_n = 10000)
```

We see that as expected_error_rate goes near to allowed_error_rate, the number
of draws needed rises more strongly.

For the moment drawsneeded_plot() can not picture this in one plot.

## Still TODO

* Handle case where only integer values of k are possible. For example when k > 1 -
cert, then round k up. Otherwise round k down.
* Possibly, add extra margin, so extra draws, by taking into account the standard deviation.
* There is something strange: you pretend to know something
  about the file to be audited, i.e. expected_error_rate > 0,
  but you do not want to use that info in the estimation, or is that
  correct as this only concerns the planning phase? I get a bit confused.
* drawsneeded_plot(): work nicely with parameters of
  drawsneeded() that have length > 1.
* drawsneeded_plot(): if possible, depict situation when too many draws are needed.
